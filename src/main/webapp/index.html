<!DOCTYPE html>
<meta charset="utf-8">
<style>
	.node {
		stroke: #fff;
		stroke-width: 1.5px;
	}

	.link {
		stroke: #999;
		stroke-opacity: .6;
	}

</style>
<body>
	<input type="text" id="txtGroupName"/>
	<input type="button" id="btnLoad" value="load" onclick="load(document.getElementById('txtGroupName').value)"/>
	<div id="d3container"></div>

	<script src="http://d3js.org/d3.v3.min.js"></script>
	<script type="text/javascript">
		function load(id) {

			var w = 1000, h = 200;
			var mt = 20, mb = 20, ml = 10, mr = 10;

			var svg = d3.select("body").append("svg").attr("width", w).attr("height", h);

			d3.json("/genealogy?id=" + id, function(err, data) {
				var svg = d3.select("#d3container").append("svg").attr("width", w).attr("height", h);
				svg.selectAll("circle").data(data.nodes).enter().append("circle").attr("r", function(d) {
					return Math.min(20, Math.floor((h - mt - mb) / (4 * data.lines)), Math.floor((w - ml - mr) / (4 * data.revs)));
				}).attr("cx", function(d) {
					return Math.floor(ml + (d.xIndex + 1) * (w - ml - mr) / data.revs);
				}).attr("cy", function(d) {
					return Math.floor(mt + (d.yIndex + 1) * (h - mt - mb) / data.lines);
				});
			});

		}

	</script>

</body>
